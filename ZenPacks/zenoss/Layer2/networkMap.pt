<!DOCTYPE html>
<!--
##############################################################################
# 
# Copyright (C) Zenoss, Inc. 2014, all rights reserved.
# 
# This content is made available according to terms specified in
# License.zenoss under the directory where your Zenoss product is installed.
# 
##############################################################################

Uses code from Products/ZenUI3/browser/templates/networkMap.pt
-->

<tal:block metal:use-macro="context/page_macros/base-new">
    <tal:block metal:fill-slot="title">Network map</tal:block>

    <tal:block metal:fill-slot="head-local">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <script type="text/javascript"
            tal:define="
                classlist python:[dict(label=x,data='/zport/dmd/Devices'+x) for x in here.dmd.Devices.deviceMoveTargets()];
                loclist python:[dict(label=x, data='/zport/dmd/Locations'+x) for x in here.dmd.Locations.deviceMoveTargets()];
                grouplist python:[dict(label=x, data='/zport/dmd/Groups'+x) for x in here.dmd.Groups.deviceMoveTargets()];
                syslist python:[dict(label=x, data='/zport/dmd/Systems'+x) for x in here.dmd.Systems.deviceMoveTargets()];
                layerslist python: [dict(boxLabel=x, inputValue='layer_' + x) for x in here.dmd.getNetworkLayers()];"
            tal:content="string:
                window.filter_type_options = {
                    'Device Class': ${classlist},
                    'Location': [{label:'/', data:'/'}].concat(${loclist}),
                    'Group': [{label:'/', data:'/'}].concat(${grouplist}),
                    'System': [{label:'/', data:'/'}].concat(${syslist}),
                    'Layers': ${layerslist}
                };
        "></script>

        <script type="text/javascript" src="/++resource++ZenPacks_zenoss_Layer2/js/d3.v3.min.js"></script>
        <script type="text/javascript" src="/++resource++ZenPacks_zenoss_Layer2/js/graph_renderer.js"></script>
        <script type="text/javascript" src="/++resource++ZenPacks_zenoss_Layer2/js/render_network_map.js"></script>
        <style type="text/css">
        .node text {
            pointer-events: none;
            font: 10px sans-serif;
        }
        </style>
    </tal:block>

    <tal:block metal:fill-slot="script_afterLayout">
        <script type="text/javascript">
            Ext.onReady(function(){
                render_form(Ext.getCmp('center_panel'));
            });
        </script>
    </tal:block>
</tal:block>
