== Support ==
This is an Open Source ZenPack developed by Zenoss, Inc. Enterprise support for this ZenPack is available to commercial customers with an active subscription.

== Background ==
This ZenPack provides support to model OSI Layer 2 (or data link layer) topology. Than that topology information is used to suppress events from devices connection to which was lost because they are connected to broken devices.  Data collection is performed using SNMP.

== Gallery ==
<gallery widths=250px heights=127px>
CDPLLDPDiscover.PNG
ClientMACs.PNG
NeighborSwitches.PNG
</gallery>

== Features ==

The features added by this ZenPack can be summarized as follows. They are each detailed further below.

* Discovery and periodic remodeling of Neighbor Switches using CDP/LLDP.
* Monitoring of MAC Address table or Forwarding Table for each network interface of device.
* Event suppression based on MAC Address table.

=== Discovered components ===
Layer2 ZenPack adds almost no new components by itself, it just models client mac addresses on interfaces of existing bridge devices.

But, CDP/LLDP based collector plugin ''zenoss.snmp.CDPLLDPDiscover'' performs discovery of switches, located nearby selected device.

=== Monitoring ===
ZenPack binds ''Layer2Info'' monitoring templates to ''/Network'' device class in Zenoss. This results in monitoring Layer 2 MAC forwarding tables for such devices. On a detail view of ''Interfaces'' component added ''Clients MAC addresses'' sub-panel with a list of MAC addresses. Those are grouped by client device they belong to.

This ZenPack provides no performance monitoring, and generates no events, all that it does is build network topology, and then perform event suppression based on that topology.

=== Event suppression ===

Situation when upstream switch goes down results in flooding with ''Device is DOWN!'' events for every device in this subnet. ZenPack adds zenevent plugin which suppresses such subsequent events for leaf devices. So system administrator receives only primary, core error event.

== Usage ==
To use this ZenPack on some device or class of devices, you should bind Layer2Info monitoring template to that device, and in case SNMP community string in configuration properties is correct, after next monitoring cycle, interfaces will have client MAC addresses property, on panel under the components grid.

To model neighbor switches you should add <code>zenoss.snmp.CDPLLDPDiscover</code> modeler plugin.

== Requirements ==

This ZenPack has the following requirements.

;[[ZenPack:PythonCollector|PythonCollector ZenPack]]
: This ZenPack depends on [[ZenPack:PythonCollector|PythonCollector]] being installed, and having the associated ''zenpython'' collector process running.

== Service Impact ==

When combined with the Zenoss Service Dynamics product, this ZenPack adds built-in service impact capability based on Layer 2 data. The following service impact relationships are automatically added. These will be included in any services that contain one or more of the explicitly mentioned entities.

;Service Impact Relationships
* Device impacted by upstream switch device.

== Troubleshooting ==

Please refer the the Zenoss Service Dynamics documentation if you run into any of the following problems:

* ZenPack will not install
* Adding a device fails
* Don't understand how to add a device
* Don't understand how to model a device

If you cannot find the answer in the documentation, then Resource Manager (Service Dynamics) users should contact [https://support.zenoss.com Zenoss Customer Support]. Core users can use the #zenoss IRC channel or the community.zenoss.org forums.

== Layer2 Terminology ==
The essential mechanism that separates network switches from network hubs is the MAC forwarding table. Instead of broadcasting incoming frames of link layer to all it's interfaces, as hub do, switch looks into forwarding table to find out to which particular interface is connected destination device. Switch learns which devices are connected to which interfaces by looking at the source MAC address of incoming frames. Those MAC addresses are called "client MAC addresses".

== Installed Items ==

Installing this ZenPack will add the following items to your Zenoss system.

;Modeler Plugins
* zenoss.snmp.CDPLLDPDiscover

;Monitoring Templates
* Layer2Info (in /Network)

== Changes ==

;1.0.1
* Fix device overview links error. (ZEN-14063)
* Remove add/remove from catalog logging. (ZEN-15465)
* Fix usage of incorrect community VLAN suffixes on BRIDGE-MIB queries. (ZEN-16951)
* Fix looping of impact relationships between switches. (ZEN-17020)
* Fix incorrect modeling of neighbor switches and improve modeling time. (ZEN-17023)
* Stop binding Layer2Info template to /Network by default. (ZEN-17035)

;1.0.0
* Initial release
